---
layout: default
---
<div class="post">

  <header class="post-header">
    <h1 class="post-title">{{ page.title }}</h1>
    <p class="post-meta">{{ page.date | date: "%b %-d, %Y" }}{% if page.author %} • {{ page.author }}{% endif %}{% if page.meta %} • {{ page.meta }}{% endif %}</p>
  </header>

  <article class="post-content">
    {{ content }}
  </article>

  <div>
    <h3><strong><em>Comments</em></strong></h3>
    <div>
      Want to leave a comment? Write your comment
      <a href="https://github.com/colinxy/colinxy.github.io/issues/{{page.commentIssueId}}">here</a>.
    </div>
    <div id="comments"></div>
  </div>

  <script type="text/javascript">

   var commentIssueId = {{ page.commentIssueId }};
   /* console.log(commentIssueId);*/

   function formatComment(user, userUrl, avatar, date, commentUrl, body) {
     /* header */
     var commentHeaderAvatar = document.createElement("div");
     commentHeaderAvatar.innerHTML = "<img src='" + avatar +
                                     "' width='20' height='20'>";
     var usr = document.createElement("a"); /* user */
     usr.href = userUrl;
     usr.innerHTML = user;
     var commentHeaderUser = document.createElement("div"); /* user div */
     commentHeaderUser.class = "commentHeaderUser";
     commentHeaderUser.appendChild(usr);
     var dat = document.createElement("a"); /* date */
     dat.href = commentUrl;
     dat.innerHTML = date;
     var commentHeaderDate = document.createElement("div"); /* date div */
     commentHeaderDate.appendChild(dat);

     var commentHeader = document.createElement("div");
     commentHeader.class = "commentHeader";
     commentHeader.appendChild(commentHeaderAvatar).
                   appendChild(commentHeaderUser).
                   appendChild(commentHeaderDate);

     /* body */
     var commentBody = document.createElement("div");
     commentBody.class = "commentBody";
     commentBody.innerHTML = body;

     /* comment (header + body) */
     var comment = document.createElement("div");
     comment.class = "comment";
     comment.appendChild(commentHeader).
             appendChild(commentBody);

     return comment;
   }

   if (commentIssueId) {
     console.log("loading comments...");

     var url = "https://api.github.com/repos/colinxy/colinxy.github.io/issues/" +
               commentIssueId + "/comments";

     var request = new XMLHttpRequest();
     request.onload = function() {
       var response = JSON.parse(request.responseText);
       /* console.log(response);*/
       var comments = document.getElementById("comments");

       for ( var i = 0; i < response.length; i++) {
         var user = response[i].user.login;
         var userUrl = response[i].user.html_url;
         var avatar = response[i].user.avatar_url;
         var date = new Date(response[i].updated_at).toDateString();
         var commentUrl = response[i].html_url;
         var body = response[i].body_html;

         comments.appendChild(formatComment(user, userUrl, avatar,
                                            date, commentUrl, body));
       }

     };
     request.error = function() {
       console.log("error loading comments");
     };

     request.open('GET', url, true);
     request.setRequestHeader("Accept", "application/vnd.github.v3.html+json");
     request.send();
   }
  </script>

</div>
